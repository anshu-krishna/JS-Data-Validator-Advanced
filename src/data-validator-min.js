function isObject(t){return null!==t&&"object"==typeof t}export class Ret{value;valid;error;constructor(t,e){t=!!t,this.valid=t,this.value=t?e:null,this.error=t?null:e}static Valid(t=null){return new Ret(!0,t)}static Invalid(t=null){return new Ret(!1,t)}}const Parser=function(){"use strict";function t(e,r,n,i){this.message=e,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(t,Error),t.buildMessage=function(t,e){let r={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){let e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?s(t.parts[e][0])+"-"+s(t.parts[e][1]):s(t.parts[e]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}return"Expected "+function(t){let e,n,i=new Array(t.length);for(e=0;e<t.length;e++)i[e]=(s=t[e],r[s.type](s));var s;if(i.sort(),i.length>0){for(e=1,n=1;e<i.length;e++)i[e-1]!==i[e]&&(i[n]=i[e],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,r){r=void 0!==r?r:{};let n,i={},s={Format:Ae},a=Ae,u="=>",o=de("=>",!1),l=function(t,e){return e},c=de("|",!1),f=function(t,e){return e},h=function(t,e){return Object.fromEntries([t,...e])},d="...",p=de("...",!1),y=ye("identifier:data-type pair"),g=de("?",!1),m=de("=",!1),b=ye("repeat-count"),v="..",A=de("..",!1),w=ye("function-list"),$=function(t,e){return[t,...e]},x=ye("function"),R=".",C=de(".",!1),E=ye("object"),O=function(t,e){return e},I=ye("key:val pair"),S=ye("key"),N=ye("identifier"),T=/^[_a-z$]/i,j=pe(["_",["a","z"],"$"],!1,!0),F=/^[0-9a-z$_]/i,k=pe([["0","9"],["a","z"],"$","_"],!1,!0),_=ye("value-list"),J=ye("null"),V="null",D=de("null",!1),U=ye("undefined"),M="undefined",z=de("undefined",!1),L=(ye("bool"),"false"),P=de("false",!1),q="true",B=de("true",!1),H=ye("number"),G="-",K=de("-",!1),Q=de("0x",!1),W=de("0o",!1),X=/^[0-7]/,Y=pe([["0","7"]],!1,!1),Z=de("0b",!1),tt=/^[0-1]/,et=pe([["0","1"]],!1,!1),rt=/^[eE]/,nt=pe(["e","E"],!1,!1),it=de("+",!1),st=function(){return parseFloat(e.substring(oe,ue))},at=ye("string"),ut=de('"',!1),ot=/^[^\0-\x1F\\"]/,lt=pe([["\0",""],"\\",'"'],!0,!1),ct=function(t){return t.join("")},ft=de("'",!1),ht=/^[^\0-\x1F\\']/,dt=pe([["\0",""],"\\","'"],!0,!1),pt=de("`",!1),yt=/^[^\0-\x1F\\`]/,gt=pe([["\0",""],"\\","`"],!0,!1),mt=de("\\\\",!1),bt=de('\\"',!1),vt=de("\\'",!1),At=de("\\`",!1),wt=de("\\b",!1),$t=de("\\f",!1),xt=de("\\n",!1),Rt=de("\\r",!1),Ct=de("\\t",!1),Et=de("\\0",!1),Ot=de("\\x",!1),It=function(t){return String.fromCharCode(parseInt(t,16))},St=de("\\u",!1),Nt=/^[\n]/,Tt=pe(["\n"],!1,!1),jt=/^[\t]/,Ft=pe(["\t"],!1,!1),kt=ye("whitespace"),_t=/^[ \t\n\r]/,Jt=pe([" ","\t","\n","\r"],!1,!1),Vt=ye("Comment"),Dt=de("/*",!1),Ut=/^[^*]/,Mt=pe(["*"],!0,!1),zt=de("*",!1),Lt=/^[\/]/,Pt=pe(["/"],!1,!1),qt=de("*/",!1),Bt=de("//",!1),Ht=/^[^\n]/,Gt=pe(["\n"],!0,!1),Kt=ye("Hex-Char"),Qt=/^[0-9a-f]/i,Wt=pe([["0","9"],["a","f"]],!1,!0),Xt=/^[0-9]/,Yt=pe([["0","9"]],!1,!1),Zt=de(",",!1),te=de(":",!1),ee=de("[",!1),re=de("]",!1),ne=de("{",!1),ie=de("}",!1),se=de("(",!1),ae=de(")",!1),ue=0,oe=0,le=[{line:1,column:1}],ce=0,fe=[],he=0;if("startRule"in r){if(!(r.startRule in s))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=s[r.startRule]}function de(t,e){return{type:"literal",text:t,ignoreCase:e}}function pe(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function ye(t){return{type:"other",description:t}}function ge(t){let r,n=le[t];if(n)return n;for(r=t-1;!le[r];)r--;for(n=le[r],n={line:n.line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return le[t]=n,n}function me(t,e){let r=ge(t),n=ge(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function be(t){ue<ce||(ue>ce&&(ce=ue,fe=[]),fe.push(t))}function ve(e,r,n){return new t(t.buildMessage(e,r),e,r,n)}function Ae(){let t,r,n,s,a,c,f,h,d;if(t=ue,r=_e(),r!==i)if(n=we(),n!==i){for(s=[],a=ue,c=_e(),c!==i?(e.substr(ue,2)===u?(f=u,ue+=2):(f=i,0===he&&be(o)),f!==i?(h=_e(),h!==i?(d=we(),d!==i?(oe=a,c=l(0,d),a=c):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i);a!==i;)s.push(a),a=ue,c=_e(),c!==i?(e.substr(ue,2)===u?(f=u,ue+=2):(f=i,0===he&&be(o)),f!==i?(h=_e(),h!==i?(d=we(),d!==i?(oe=a,c=l(0,d),a=c):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i);s!==i?(oe=t,r=function(t,e){let r=[t,...e];for(;r.length>1;){const t=r.pop();r[r.length-1].nx=t}return r[0]}(n,s),t=r):(ue=t,t=i)}else ue=t,t=i;else ue=t,t=i;return t===i&&(t=ue,r=_e(),r!==i?(n=we(),n!==i?(r=[r,n],t=r):(ue=t,t=i)):(ue=t,t=i)),t}function we(){let t,r,n,s,a,u,o,l,y;if(t=ue,r=Be(),r!==i)if(n=Ae(),n!==i){for(s=[],a=ue,u=_e(),u!==i?(124===e.charCodeAt(ue)?(o="|",ue++):(o=i,0===he&&be(c)),o!==i?(l=_e(),l!==i?(y=Ae(),y!==i?(oe=a,u=f(0,y),a=u):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i);a!==i;)s.push(a),a=ue,u=_e(),u!==i?(124===e.charCodeAt(ue)?(o="|",ue++):(o=i,0===he&&be(c)),o!==i?(l=_e(),l!==i?(y=Ae(),y!==i?(oe=a,u=f(0,y),a=u):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i);s!==i?(a=He(),a!==i?(u=Re(),u===i&&(u=null),u!==i?(oe=t,r=function(t,e,r){const n=[t,...e];if(1===n.length){let t=[...n[0]?.fn??[],...r??[]];return 0===t.length&&(t=null),Ge({...n[0],fn:t})}return Ge({ty:"@or@",ls:n,fn:r})}(n,s,u),t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;else ue=t,t=i;if(t===i){if(t=ue,r=ze(),r!==i){if(n=ue,s=xe(),s!==i){for(a=[],u=ue,o=Ue(),o!==i?(l=xe(),l!==i?(oe=u,o=f(0,l),u=o):(ue=u,u=i)):(ue=u,u=i);u!==i;)a.push(u),u=ue,o=Ue(),o!==i?(l=xe(),l!==i?(oe=u,o=f(0,l),u=o):(ue=u,u=i)):(ue=u,u=i);a!==i?(u=Ue(),u===i&&(u=null),u!==i?(oe=n,g=a,s=[s,...g],n=s):(ue=n,n=i)):(ue=n,n=i)}else ue=n,n=i;n===i&&(n=null),n!==i?(s=Le(),s!==i?(a=Re(),a===i&&(a=null),a!==i?(oe=t,r=Ge({ty:"@arr@",ls:n??[],fn:a}),t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;if(t===i){if(t=ue,r=Pe(),r!==i){if(n=ue,s=$e(),s!==i){for(a=[],u=ue,o=Ue(),o!==i?(l=$e(),l!==i?(oe=u,o=f(0,l),u=o):(ue=u,u=i)):(ue=u,u=i);u!==i;)a.push(u),u=ue,o=Ue(),o!==i?(l=$e(),l!==i?(oe=u,o=f(0,l),u=o):(ue=u,u=i)):(ue=u,u=i);a!==i?(oe=n,s=h(s,a),n=s):(ue=n,n=i)}else ue=n,n=i;n===i&&(n=null),n!==i?(s=ue,a=Ue(),a!==i?(e.substr(ue,3)===d?(u=d,ue+=3):(u=i,0===he&&be(p)),u!==i?(a=[a,u],s=a):(ue=s,s=i)):(ue=s,s=i),s===i&&(s=null),s!==i?(a=Ue(),a===i&&(a=null),a!==i?(u=qe(),u!==i?(o=Re(),o===i&&(o=null),o!==i?(oe=t,r=function(t,e,r){const n=Ge({ty:"@obj@",ls:t,fn:r});return e&&(n.kp=!0),n}(n,s,o),t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;t===i&&(t=ue,r=Ie(),r!==i?(n=Re(),n===i&&(n=null),n!==i?(oe=t,r=function(t,e){return Ge({ty:t,fn:e})}(r,n),t=r):(ue=t,t=i)):(ue=t,t=i))}}var g;return t}function $e(){let t,r,n,s,a,u,o,l,c,f;var h,d,p;return he++,t=ue,63===e.charCodeAt(ue)?(r="?",ue++):(r=i,0===he&&be(g)),r===i&&(r=null),r!==i?(n=Ie(),n===i&&(n=Fe()),n!==i?(s=ue,a=Be(),a!==i?(u=_e(),u!==i?(61===e.charCodeAt(ue)?(o="=",ue++):(o=i,0===he&&be(m)),o!==i?(l=_e(),l!==i?(c=Ee(),c!==i?(f=He(),f!==i?(oe=s,a={val:c},s=a):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i),s===i&&(s=null),s!==i?(a=Me(),a!==i?(u=Ae(),u!==i?(oe=t,h=n,d=s,p=u,null===r&&(p.rq=!0),null!==d&&(p.def=d.val),r=[h,p],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),he--,t===i&&(r=i,0===he&&be(y)),t}function xe(){let t,r,n;var s,a;return t=ue,r=function(){let t,r,n,s,a;he++,t=ue,e.substr(ue,2)===v?(r=v,ue+=2):(r=i,0===he&&be(A));r!==i?(n=je(),n!==i?(e.substr(ue,2)===v?(s=v,ue+=2):(s=i,0===he&&be(A)),s!==i?(a=_e(),a!==i?(oe=t,u=n,r=Math.floor(Math.abs(u)),t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i);var u;t===i&&(t=ue,e.substr(ue,3)===d?(r=d,ue+=3):(r=i,0===he&&be(p)),r!==i?(n=_e(),n!==i?(oe=t,r="yes",t=r):(ue=t,t=i)):(ue=t,t=i));he--,t===i&&(r=i,0===he&&be(b));return t}(),r===i&&(r=null),r!==i?(n=Ae(),n!==i?(oe=t,a=n,(s=r)&&(a.rpt=s),r=a,t=r):(ue=t,t=i)):(ue=t,t=i),t}function Re(){let t,e,r,n;if(he++,t=ue,e=Ce(),e!==i){for(r=[],n=Ce();n!==i;)r.push(n),n=Ce();r!==i?(oe=t,e=$(e,r),t=e):(ue=t,t=i)}else ue=t,t=i;return he--,t===i&&(e=i,0===he&&be(w)),t}function Ce(){let t,r,n,s,a,u,o,l,c;return he++,t=ue,r=_e(),r!==i?(46===e.charCodeAt(ue)?(n=R,ue++):(n=i,0===he&&be(C)),n!==i?(s=Ie(),s!==i?(a=ue,u=Be(),u!==i?(o=Se(),o===i&&(o=null),o!==i?(l=Ue(),l===i&&(l=null),l!==i?(c=He(),c!==i?(oe=a,u=o,a=u):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i)):(ue=a,a=i),a===i&&(a=null),a!==i?(oe=t,r=function(t,e){const r={fn:t};return e&&(r.args=e),r}(s,a),t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),he--,t===i&&(r=i,0===he&&be(x)),t}function Ee(){let t,r,n,s;return t=ue,r=_e(),r!==i?(n=function(){let t,r;he++,t=ue,e.substr(ue,4)===V?(r=V,ue+=4):(r=i,0===he&&be(D));r!==i&&(oe=t,r=null);t=r,he--,t===i&&(r=i,0===he&&be(J));return t}(),n===i&&(n=function(){let t,r;he++,t=ue,e.substr(ue,9)===M?(r=M,ue+=9):(r=i,0===he&&be(z));r!==i&&(oe=t,r=void 0);t=r,he--,t===i&&(r=i,0===he&&be(U));return t}(),n===i&&(n=Te(),n===i&&(n=Ne(),n===i&&(n=je(),n===i&&(n=Fe()))))),n!==i?(s=_e(),s!==i?(oe=t,r=n,t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t===i&&(t=function(){let t,e,r,n,s,a,u,o;if(he++,t=ue,e=Pe(),e!==i){if(r=ue,n=Oe(),n!==i){for(s=[],a=ue,u=Ue(),u!==i?(o=Oe(),o!==i?(oe=a,u=O(0,o),a=u):(ue=a,a=i)):(ue=a,a=i);a!==i;)s.push(a),a=ue,u=Ue(),u!==i?(o=Oe(),o!==i?(oe=a,u=O(0,o),a=u):(ue=a,a=i)):(ue=a,a=i);s!==i?(oe=r,n=h(n,s),r=n):(ue=r,r=i)}else ue=r,r=i;r===i&&(r=null),r!==i?(n=Ue(),n===i&&(n=null),n!==i?(s=qe(),s!==i?(oe=t,e=null!==(l=r)?l:{},t=e):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;var l;he--,t===i&&(e=i,0===he&&be(E));return t}(),t===i&&(t=function(){let t,e,r,n,s;t=ue,e=ze(),e!==i?(r=Se(),r===i&&(r=null),r!==i?(n=Ue(),n===i&&(n=null),n!==i?(s=Le(),s!==i?(oe=t,e=r??[],t=e):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i);return t}())),t}function Oe(){let t,r,n,s;return he++,t=ue,r=Fe(),r===i&&(r=function(){let t,r,n,s,a,u,o;if(he++,t=ue,r=ue,n=Ie(),n!==i){for(s=[],a=ue,46===e.charCodeAt(ue)?(u=R,ue++):(u=i,0===he&&be(C)),u!==i?(o=Ie(),o!==i?(u=[u,o],a=u):(ue=a,a=i)):(ue=a,a=i);a!==i;)s.push(a),a=ue,46===e.charCodeAt(ue)?(u=R,ue++):(u=i,0===he&&be(C)),u!==i?(o=Ie(),o!==i?(u=[u,o],a=u):(ue=a,a=i)):(ue=a,a=i);s!==i?(n=[n,s],r=n):(ue=r,r=i)}else ue=r,r=i;t=r!==i?e.substring(t,ue):r;he--,t===i&&(r=i,0===he&&be(S));return t}()),r!==i?(n=Me(),n!==i?(s=Ee(),s!==i?(oe=t,r=[r,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),he--,t===i&&(r=i,0===he&&be(I)),t}function Ie(){let t,r,n,s,a;if(he++,t=ue,r=ue,T.test(e.charAt(ue))?(n=e.charAt(ue),ue++):(n=i,0===he&&be(j)),n!==i){for(s=[],F.test(e.charAt(ue))?(a=e.charAt(ue),ue++):(a=i,0===he&&be(k));a!==i;)s.push(a),F.test(e.charAt(ue))?(a=e.charAt(ue),ue++):(a=i,0===he&&be(k));s!==i?(n=[n,s],r=n):(ue=r,r=i)}else ue=r,r=i;return t=r!==i?e.substring(t,ue):r,he--,t===i&&(r=i,0===he&&be(N)),t}function Se(){let t,e,r,n,s,a;if(he++,t=ue,e=Ee(),e!==i){for(r=[],n=ue,s=Ue(),s!==i?(a=Ee(),a!==i?(oe=n,s=f(0,a),n=s):(ue=n,n=i)):(ue=n,n=i);n!==i;)r.push(n),n=ue,s=Ue(),s!==i?(a=Ee(),a!==i?(oe=n,s=f(0,a),n=s):(ue=n,n=i)):(ue=n,n=i);r!==i?(oe=t,e=$(e,r),t=e):(ue=t,t=i)}else ue=t,t=i;return he--,t===i&&(e=i,0===he&&be(_)),t}function Ne(){let t,r;return t=ue,e.substr(ue,5)===L?(r=L,ue+=5):(r=i,0===he&&be(P)),r!==i&&(oe=t,r=!1),t=r,t}function Te(){let t,r;return t=ue,e.substr(ue,4)===q?(r=q,ue+=4):(r=i,0===he&&be(B)),r!==i&&(oe=t,r=!0),t=r,t}function je(){let t,r,n,s,a,u,o,l,c;if(he++,t=ue,45===e.charCodeAt(ue)?(r=G,ue++):(r=i,0===he&&be(K)),r===i&&(r=null),r!==i)if("0x"===e.substr(ue,2)?(n="0x",ue+=2):(n=i,0===he&&be(Q)),n!==i){if(s=ue,a=[],u=Ve(),u!==i)for(;u!==i;)a.push(u),u=Ve();else a=i;s=a!==i?e.substring(s,ue):a,s!==i?(oe=t,r=parseInt(`${r??""}${s}`,16),t=r):(ue=t,t=i)}else ue=t,t=i;else ue=t,t=i;if(t===i){if(t=ue,45===e.charCodeAt(ue)?(r=G,ue++):(r=i,0===he&&be(K)),r===i&&(r=null),r!==i)if("0o"===e.substr(ue,2)?(n="0o",ue+=2):(n=i,0===he&&be(W)),n!==i){if(s=ue,a=[],X.test(e.charAt(ue))?(u=e.charAt(ue),ue++):(u=i,0===he&&be(Y)),u!==i)for(;u!==i;)a.push(u),X.test(e.charAt(ue))?(u=e.charAt(ue),ue++):(u=i,0===he&&be(Y));else a=i;s=a!==i?e.substring(s,ue):a,s!==i?(oe=t,r=function(t,e){return parseInt(`${t??""}${e}`,8)}(r,s),t=r):(ue=t,t=i)}else ue=t,t=i;else ue=t,t=i;if(t===i){if(t=ue,45===e.charCodeAt(ue)?(r=G,ue++):(r=i,0===he&&be(K)),r===i&&(r=null),r!==i)if("0b"===e.substr(ue,2)?(n="0b",ue+=2):(n=i,0===he&&be(Z)),n!==i){if(s=ue,a=[],tt.test(e.charAt(ue))?(u=e.charAt(ue),ue++):(u=i,0===he&&be(et)),u!==i)for(;u!==i;)a.push(u),tt.test(e.charAt(ue))?(u=e.charAt(ue),ue++):(u=i,0===he&&be(et));else a=i;s=a!==i?e.substring(s,ue):a,s!==i?(oe=t,r=function(t,e){return parseInt(`${t??""}${e}`,2)}(r,s),t=r):(ue=t,t=i)}else ue=t,t=i;else ue=t,t=i;if(t===i)if(t=ue,45===e.charCodeAt(ue)?(r=G,ue++):(r=i,0===he&&be(K)),r===i&&(r=null),r!==i){if(n=[],s=De(),s!==i)for(;s!==i;)n.push(s),s=De();else n=i;if(n!==i){if(s=ue,46===e.charCodeAt(ue)?(a=R,ue++):(a=i,0===he&&be(C)),a!==i){if(u=[],o=De(),o!==i)for(;o!==i;)u.push(o),o=De();else u=i;u!==i?(a=[a,u],s=a):(ue=s,s=i)}else ue=s,s=i;if(s===i&&(s=null),s!==i){if(a=ue,rt.test(e.charAt(ue))?(u=e.charAt(ue),ue++):(u=i,0===he&&be(nt)),u!==i)if(45===e.charCodeAt(ue)?(o=G,ue++):(o=i,0===he&&be(K)),o===i&&(43===e.charCodeAt(ue)?(o="+",ue++):(o=i,0===he&&be(it))),o===i&&(o=null),o!==i){if(l=[],c=De(),c!==i)for(;c!==i;)l.push(c),c=De();else l=i;l!==i?(u=[u,o,l],a=u):(ue=a,a=i)}else ue=a,a=i;else ue=a,a=i;a===i&&(a=null),a!==i?(oe=t,r=st(),t=r):(ue=t,t=i)}else ue=t,t=i}else ue=t,t=i}else ue=t,t=i}}return he--,t===i&&(r=i,0===he&&be(H)),t}function Fe(){let t,r,n,s;if(he++,t=ue,34===e.charCodeAt(ue)?(r='"',ue++):(r=i,0===he&&be(ut)),r!==i){for(n=[],ot.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(lt)),s===i&&(s=ke());s!==i;)n.push(s),ot.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(lt)),s===i&&(s=ke());n!==i?(34===e.charCodeAt(ue)?(s='"',ue++):(s=i,0===he&&be(ut)),s!==i?(oe=t,r=ct(n),t=r):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;if(t===i){if(t=ue,39===e.charCodeAt(ue)?(r="'",ue++):(r=i,0===he&&be(ft)),r!==i){for(n=[],ht.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(dt)),s===i&&(s=ke());s!==i;)n.push(s),ht.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(dt)),s===i&&(s=ke());n!==i?(39===e.charCodeAt(ue)?(s="'",ue++):(s=i,0===he&&be(ft)),s!==i?(oe=t,r=ct(n),t=r):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;if(t===i)if(t=ue,96===e.charCodeAt(ue)?(r="`",ue++):(r=i,0===he&&be(pt)),r!==i){for(n=[],yt.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(gt)),s===i&&(s=ke());s!==i;)n.push(s),yt.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(gt)),s===i&&(s=ke());n!==i?(96===e.charCodeAt(ue)?(s="`",ue++):(s=i,0===he&&be(pt)),s!==i?(oe=t,r=ct(n),t=r):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i}return he--,t===i&&(r=i,0===he&&be(at)),t}function ke(){let t,r,n,s,a,u,o,l;var c;return t=ue,"\\\\"===e.substr(ue,2)?(r="\\\\",ue+=2):(r=i,0===he&&be(mt)),r!==i&&(oe=t,r="\\"),t=r,t===i&&(t=ue,'\\"'===e.substr(ue,2)?(r='\\"',ue+=2):(r=i,0===he&&be(bt)),r!==i&&(oe=t,r='"'),t=r,t===i&&(t=ue,"\\'"===e.substr(ue,2)?(r="\\'",ue+=2):(r=i,0===he&&be(vt)),r!==i&&(oe=t,r="'"),t=r,t===i&&(t=ue,"\\`"===e.substr(ue,2)?(r="\\`",ue+=2):(r=i,0===he&&be(At)),r!==i&&(oe=t,r="`"),t=r,t===i&&(t=ue,"\\b"===e.substr(ue,2)?(r="\\b",ue+=2):(r=i,0===he&&be(wt)),r!==i&&(oe=t,r="\b"),t=r,t===i&&(t=ue,"\\f"===e.substr(ue,2)?(r="\\f",ue+=2):(r=i,0===he&&be($t)),r!==i&&(oe=t,r="\f"),t=r,t===i&&(t=ue,"\\n"===e.substr(ue,2)?(r="\\n",ue+=2):(r=i,0===he&&be(xt)),r!==i&&(oe=t,r="\n"),t=r,t===i&&(t=ue,"\\r"===e.substr(ue,2)?(r="\\r",ue+=2):(r=i,0===he&&be(Rt)),r!==i&&(oe=t,r="\r"),t=r,t===i&&(t=ue,"\\t"===e.substr(ue,2)?(r="\\t",ue+=2):(r=i,0===he&&be(Ct)),r!==i&&(oe=t,r="\t"),t=r,t===i&&(t=ue,"\\0"===e.substr(ue,2)?(r="\\0",ue+=2):(r=i,0===he&&be(Et)),r!==i?(n=ue,s=ue,X.test(e.charAt(ue))?(a=e.charAt(ue),ue++):(a=i,0===he&&be(Y)),a!==i?(X.test(e.charAt(ue))?(u=e.charAt(ue),ue++):(u=i,0===he&&be(Y)),u===i&&(u=null),u!==i?(X.test(e.charAt(ue))?(o=e.charAt(ue),ue++):(o=i,0===he&&be(Y)),o===i&&(o=null),o!==i?(a=[a,u,o],s=a):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i),n=s!==i?e.substring(n,ue):s,n!==i?(oe=t,c=n,r=String.fromCharCode(parseInt(c,8)),t=r):(ue=t,t=i)):(ue=t,t=i),t===i&&(t=ue,"\\x"===e.substr(ue,2)?(r="\\x",ue+=2):(r=i,0===he&&be(Ot)),r!==i?(n=ue,s=ue,a=Ve(),a!==i?(u=Ve(),u!==i?(a=[a,u],s=a):(ue=s,s=i)):(ue=s,s=i),n=s!==i?e.substring(n,ue):s,n!==i?(oe=t,r=It(n),t=r):(ue=t,t=i)):(ue=t,t=i),t===i&&(t=ue,"\\u"===e.substr(ue,2)?(r="\\u",ue+=2):(r=i,0===he&&be(St)),r!==i?(n=ue,s=ue,a=Ve(),a!==i?(u=Ve(),u!==i?(o=Ve(),o!==i?(l=Ve(),l!==i?(a=[a,u,o,l],s=a):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i)):(ue=s,s=i),n=s!==i?e.substring(n,ue):s,n!==i?(oe=t,r=It(n),t=r):(ue=t,t=i)):(ue=t,t=i),t===i&&(Nt.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=i,0===he&&be(Tt)),t===i&&(jt.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=i,0===he&&be(Ft))))))))))))))),t}function _e(){let t,r;for(he++,t=[],_t.test(e.charAt(ue))?(r=e.charAt(ue),ue++):(r=i,0===he&&be(Jt)),r===i&&(r=Je());r!==i;)t.push(r),_t.test(e.charAt(ue))?(r=e.charAt(ue),ue++):(r=i,0===he&&be(Jt)),r===i&&(r=Je());return he--,t===i&&(r=i,0===he&&be(kt)),t}function Je(){let t,r,n,s,a,u,o;if(he++,t=ue,"/*"===e.substr(ue,2)?(r="/*",ue+=2):(r=i,0===he&&be(Dt)),r!==i){for(n=[],Ut.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(Mt)),s===i&&(s=ue,42===e.charCodeAt(ue)?(a="*",ue++):(a=i,0===he&&be(zt)),a!==i?(u=ue,he++,Lt.test(e.charAt(ue))?(o=e.charAt(ue),ue++):(o=i,0===he&&be(Pt)),he--,o===i?u=void 0:(ue=u,u=i),u!==i?(a=[a,u],s=a):(ue=s,s=i)):(ue=s,s=i));s!==i;)n.push(s),Ut.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(Mt)),s===i&&(s=ue,42===e.charCodeAt(ue)?(a="*",ue++):(a=i,0===he&&be(zt)),a!==i?(u=ue,he++,Lt.test(e.charAt(ue))?(o=e.charAt(ue),ue++):(o=i,0===he&&be(Pt)),he--,o===i?u=void 0:(ue=u,u=i),u!==i?(a=[a,u],s=a):(ue=s,s=i)):(ue=s,s=i));n!==i?("*/"===e.substr(ue,2)?(s="*/",ue+=2):(s=i,0===he&&be(qt)),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;if(t===i)if(t=ue,"//"===e.substr(ue,2)?(r="//",ue+=2):(r=i,0===he&&be(Bt)),r!==i){for(n=[],Ht.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(Gt));s!==i;)n.push(s),Ht.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(Gt));n!==i?(Nt.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=i,0===he&&be(Tt)),s===i&&(s=null),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)}else ue=t,t=i;return he--,t===i&&(r=i,0===he&&be(Vt)),t}function Ve(){let t,r;return he++,Qt.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=i,0===he&&be(Wt)),he--,t===i&&(r=i,0===he&&be(Kt)),t}function De(){let t;return Xt.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=i,0===he&&be(Yt)),t}function Ue(){let t,r,n,s;return t=ue,r=_e(),r!==i?(44===e.charCodeAt(ue)?(n=",",ue++):(n=i,0===he&&be(Zt)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function Me(){let t,r,n,s;return t=ue,r=_e(),r!==i?(58===e.charCodeAt(ue)?(n=":",ue++):(n=i,0===he&&be(te)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function ze(){let t,r,n,s;return t=ue,r=_e(),r!==i?(91===e.charCodeAt(ue)?(n="[",ue++):(n=i,0===he&&be(ee)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function Le(){let t,r,n,s;return t=ue,r=_e(),r!==i?(93===e.charCodeAt(ue)?(n="]",ue++):(n=i,0===he&&be(re)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function Pe(){let t,r,n,s;return t=ue,r=_e(),r!==i?(123===e.charCodeAt(ue)?(n="{",ue++):(n=i,0===he&&be(ne)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function qe(){let t,r,n,s;return t=ue,r=_e(),r!==i?(125===e.charCodeAt(ue)?(n="}",ue++):(n=i,0===he&&be(ie)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function Be(){let t,r,n,s;return t=ue,r=_e(),r!==i?(40===e.charCodeAt(ue)?(n="(",ue++):(n=i,0===he&&be(se)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function He(){let t,r,n,s;return t=ue,r=_e(),r!==i?(41===e.charCodeAt(ue)?(n=")",ue++):(n=i,0===he&&be(ae)),n!==i?(s=_e(),s!==i?(r=[r,n,s],t=r):(ue=t,t=i)):(ue=t,t=i)):(ue=t,t=i),t}function Ge({ty:t,fn:e=null,ls:r=null}){const n={ty:t};return null!==e&&(n.fn=e),null!==r&&(n.ls=r),n}if(n=a(),n!==i&&ue===e.length)return n;throw n!==i&&ue<e.length&&be({type:"end"}),ve(fe,ce<e.length?e.charAt(ce):null,ce<e.length?me(ce,ce+1):me(ce,ce))}}}();export const Types=new class{#t={"@arr@":{name:"array"},"@obj@":{name:"object"},"@or@":{name:"multi-type"},any:{parse:function(t){return t}},null:{parse:function(t){if(null===t)return null;const{valid:e,value:r}=Types.parse("string",t);return e&&(""===r||"null"===r.toLowerCase())?null:void 0}},num:{parse:function(t){return Types.parse("float",t)}},float:{parse:function(t){switch(typeof t){case"number":return Number.isNaN(t)?Ret.Invalid():t;case"boolean":return t?1:0;case"object":t=String(t);case"string":return t=Number(t),Number.isNaN(t)?Ret.Invalid():t;case"function":case"symbol":case"undefined":default:return}}},int:{parse:function(t){const{valid:e,value:r}=Types.parse("float",t);if(e&&Number.isInteger(r))return r}},unsigned:{parse:function(t){const{valid:e,value:r}=Types.parse("float",t);if(e&&Number.isInteger(r)&&r>=0)return r}},bool:{parse:function(t){switch(typeof t){case"boolean":return t;default:return Boolean(t)}}},string:{parse:function(t){switch(typeof t){case"string":return t;case"object":return null===t?"null":JSON.stringify(t);case"bigint":case"number":case"boolean":return new String(t).valueOf();case"undefined":return Ret.Valid("");case"function":case"symbol":default:return}}},hex:{name:"hex-string",parse:function(t){const{valid:e,value:r}=Types.parse("string",t);if(e&&/^[0-9a-f]+$/i.test(r))return Number(r)}},email:{name:"email-string",parse:function(t){const{valid:e,value:r}=Types.parse("string",t);if(e){const t=document?.createElement("input");if(null!==t){if(t.type="email",t.value=r,t.checkValidity())return r}else if(/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(r))return r}}},base64:{name:"base64-string",parse:function(t){const{valid:e,value:r}=Types.parse("string",t);if(e)try{return atob(r.replace(/-/g,"+").replace(/_/g,"/"))}catch(t){}}},json:{name:"json-string",parse:function(t){switch(typeof t){case"bigint":case"boolean":case"number":case"object":return t;case"string":try{return JSON.parse(t)}catch(t){}break;case"symbol":case"undefined":case"function":default:return}}},timestamp:{name:"timestamp-string",parse:function(t){const{valid:e,value:r}=Types.parse("string",t);if(e&&(val=new Date(r).valueOf(),NaN===val&&(val=Date.parse(r)),NaN!==val))return val}}};add({type:t,name:e=null,handler:r}){if("string"!=typeof t)throw new TypeError("Type must be a string");if(null!==e&&"string"!=typeof e)throw new TypeError("Name must be a string");if("function"!=typeof r)throw new TypeError("Handler must be a funciton");this.#t[t]={parse:r},null!==e&&(this.#t[t].name=e)}name(t){return void 0===this.#t[t]?null:this.#t[t].name??t}parse(t,e){if(void 0===this.#t[t])return Ret.Invalid(`Unknown type: ${JSON.stringify(t)}`);const r=this.#t[t].parse(e);return void 0===r?Ret.Invalid(`Expected type: '${this.name(t)}'; Received: ${JSON.stringify(e)}`):r instanceof Ret?(r.valid||(r.error??=`Expected type: '${this.name(t)}'; Received: ${JSON.stringify(e)}`),r):Ret.Valid(r)}};export const Funcs=new class{#e=[{name:"_toString",ty:["any"],fn:function(t){const{valid:e,value:r}=Types.parse("string",t);if(e)return r}},{name:"_allowed",ty:["any"],fn:function(t,...e){return e.includes(t)?t:Ret.Invalid(`Disallowed value: ${JSON.stringify(t)}`)}},{name:"_at",ty:["@arr@"],fn:function(t,...e){for(p of e)if("number"!=typeof p)throw new RangeError(`Only numeric arguments allowed; Args=${JSON.stringify(e)}`);const r=e.map((e=>t.at(e)));return 1===r.length?r[0]:r}},{name:"_slice",ty:["@obj@","any"],fn:function(t,...e){const r=[];for(const n of e)Object.hasOwn(t,n)&&r.push([n,t[n]]);switch(e.length){case 0:return null;case 1:return 0===r.length?null:r[0][1];default:return Object.fromEntries(r)}}},{name:"_title",ty:["string"],fn:function(t){return t.replace(/\w\S*/g,(t=>`${t.charAt(0).toUpperCase()}${t.substring(1).toLowerCase()}`))}},{name:"_isUUID4",ty:["string"],fn:function(t){if(/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(t))return t.toLowerCase();throw new TypeError("Not a UUID4 string")}},{name:"_range",ty:["float","num","int","unsigned"],fn:function(t,e=null,r=null){if(null!==e&&"number"!=typeof e)throw new TypeError("Only null or number allowed as arguments");if(null!==r&&"number"!=typeof r)throw new TypeError("Only null or number allowed as arguments");return null!==e&&t<e||null!==r&&t>r?Ret.Invalid(`Expected range [${e??"null"}, ${r??"null"}]`):t}},{name:"_add",ty:["float","num","int","unsigned"],fn:function(t,e=0){if("number"==typeof e)return t+e;throw new TypeError("Only numeric argument allowed")}},{name:"_sub",ty:["float","num","int","unsigned"],fn:function(t,e=0){if("number"==typeof e)return t-e;throw new TypeError("Only numeric argument allowed")}},{name:"_mul",ty:["float","num","int","unsigned"],fn:function(t,e=1){if("number"==typeof e)return t*e;throw new TypeError("Only numeric argument allowed")}},{name:"_div",ty:["float","num","int","unsigned"],fn:function(t,e=1){if("number"==typeof e&&0!==e)return t/e;throw new TypeError("Only non-zero numeric argument allowed")}},{name:"_mod",ty:["float","num","int","unsigned"],fn:function(t,e){if("number"==typeof e&&0!==e)return t%e;throw new TypeError("Only non-zero numeric argument allowed")}},{name:"_exp",ty:["float","num","int","unsigned"],fn:function(t,e=1){if("number"==typeof e)return t**e;throw new TypeError("Only numeric argument allowed")}},{name:"_round",ty:["float","num","int","unsigned"],fn:function(t,e=2){if("number"==typeof e)return Number(t.toFixed(e));throw new TypeError("Only numeric argument allowed")}}];#r=[];constructor(){this.reInit()}add(t,e,...r){if("function"!=typeof t)throw new TypeError("Invalid handler");if("string"!=typeof e)throw new TypeError("Invalid name");for(const t of r)if(null===Types.name(t))throw new TypeError(`Invalid type: ${JSON.stringify(t)}`);"_"!==e.at()&&(e=`_${e}`),this.#e.push({name:e,ty:r,fn:t}),this.reInit()}reInit(){this.#r=this.#e.map((({name:t,ty:e})=>e.map((e=>`${e}.${t}`)))).flat(1)}exists(t,e){return this.#r.includes(`${t}.${e}`)?1:!!this.#r.includes(`any.${e}`)&&2}getFn(t,e){let r;switch(this.exists(t,e)){case!1:return null;case 1:r=t;break;case 2:r="any";break}for(const t of this.#e)if(t.name===e&&t.ty.includes(r))return t.fn;return null}runFn(t,e,r,n){if("_"===e.at()){const i=this.getFn(t,e);if("function"!=typeof i)return Ret.Invalid(`Function missing: "${t}.${e}";`);try{const s=i(r,...n);return void 0===s?Ret.Invalid(`Function ${t}.${e} Error; Failed; Received: ${JSON.stringify(r)}`):s instanceof Ret?(s.valid||(s.error=`Function ${t}.${e} Error; ${s.error??""}; Received: ${JSON.stringify(r)}`),s):Ret.Valid(s)}catch(n){return Ret.Invalid(`Function ${t}.${e} Error; ${n.message}; Received: ${JSON.stringify(r)}`)}}else{if("function"!=typeof r[e])return Ret.Invalid(`There is no native function '${e}' for type '${Object.prototype.toString.call(r)}'`);try{const t=r[e](...n);return Ret.Valid(t)}catch(n){return Ret.Invalid(`Function ${t}.${e} Error; ${n.message}; Received: ${JSON.stringify(r)}`)}}}};export class DataValidator{static New(t,...e){function r(t){switch(typeof t){case"object":return JSON.stringify(t);case"function":return r(t());default:return String(t)}}let n=[];for(let i=0,s=t.length-1;i<s;i++)n.push(t[i]),n.push(r(e[i]));n.push(t[t.length-1]),n=n.join("");try{const t=new DataValidator(Parser.parse(n));return t.__structureSyntax__=n,t}catch(t){throw t instanceof Parser.SyntaxError?new Error(`Parse Error; Line:${t.location.start.line}; Column:${t.location.start.column}; ${t.message}`):new Error(t.message)}}static#n(t){t.idx=-1,t.len=t.length-1,t.rpt=0,t.next=function(t=!1){return 0===this.rpt?(this.idx++,this.rpt="reset",this.idx>this.len?"error":this.next()):"reset"===this.rpt?(this.rpt=this[this.idx].rpt??1,this.next(t)):"yes"===this.rpt?t?this.idx===this.len?"error":(this.rpt=0,this.next(t)):this[this.idx]:(this.rpt--,this[this.idx])}}static#i(t,e=0){if(!isObject(t))return Ret.Invalid("Not an object");const{ty:r=null,fn:n=[],nx:i=null}=t;if("string"!=typeof r||null===Types.name(r))return Ret.Invalid(`Unknown type: ${JSON.stringify(r)}`);{let n=null;switch(r){case"@obj@":n=t=>`{${t}}`;break;case"@arr@":n=t=>`[${t}]`;break;case"@or@":n=t=>"(multi-type)";break;default:break}if(null!==n){const r=t.ls??[];for(const[t,i]of Object.entries(r)){const r=DataValidator.#i(i,e+1);if(!r.valid)return r.error=`${n(t)}: ${r.error}`,r}}}for(const t of n)if("_"===t.fn.at()&&!Funcs.exists(r,t.fn))return Ret.Invalid(`Unknown Function: '${r}.${t.fn}'`);if(null!==i){const t=DataValidator.#i(i,e+1);if(!t.valid)return t.error=`${Types.name(r)}\n=> ${t.error}`,t}return Ret.Valid()}#s;constructor(t,e=!0){if(e){const e=DataValidator.#i(t);if(null!==e.error)throw new Error(`StructError: ${e.error}`)}this.#s=t}get struct(){return this.#s}validate(t){return DataValidator.#a(t,this.#s)}static#a(t,e,r=0){const{ty:n=null,fn:i=[],nx:s=null}=e;switch(n){case"@arr@":{if(!Array.isArray(t))return Ret.Invalid(`Expected array; Received ${JSON.stringify(t)};`);const n=[],i=e.ls??[];DataValidator.#n(i);let s=i.next();const a=Object.entries(t);for(let t=0,e=a.length;t<e;t++){const[e,u]=a[t];if("error"===s)return Ret.Invalid(`[${e}] Index out of bounds`);let o=DataValidator.#a(u,s,r+1);if(!o.valid){if("many"===i.more&&i.idx!==i.len){s=i.next(!0),t--;continue}return Ret.Invalid(`[${e}]: ${o.error}`)}n.push(o.value),s=i.next()}t=n}break;case"@obj@":{if(!isObject(t))return Ret.Invalid(`Expected object; Received ${JSON.stringify(t)};`);const n=e.ls??{};for(const[e,{def:r}]of Object.entries(n))void 0!==r&&void 0===t[e]&&(t[e]=r);const i=Object.keys(n);{const e=i.filter((t=>n[t].rq??!1)),r=Object.keys(t),s=[];for(const t of e)r.includes(t)||s.push(`{${t}}`);if(0!==s.length)return Ret.Invalid(`Missing object key(s): ${s.join(", ")}; Received ${JSON.stringify(t)};`)}const s=e.kp??!1,a={};for(const[e,u]of Object.entries(t))if(i.includes(e)){const t=DataValidator.#a(u,n[e],r+1);if(!t.valid)return Ret.Invalid(`{${e}}: ${t.error}`);a[e]=t.value}else s&&(a[e]=u);t=a}break;case"@or@":{const n=e.ls??[];let i=null;for(const e of n)if(i=DataValidator.#a(t,e,r+1),i.valid)break;if(null===i||!i.valid)return Ret.Invalid(`Expected type(s): (${n.map((t=>t.ty??"undefined")).join("|")}); Received: ${JSON.stringify(t)};`);t=i.value}break;default:{const e=Types.parse(n,t);if(!e.valid)return Ret.Invalid(`Expected type: ${Types.name(n)}; Received: ${JSON.stringify(t)};`);t=e.value}break}for(const e of i){let{fn:r="undefined",args:i=[]}=e;const s=Funcs.runFn(n,r,t,i);if(!s.valid)return s.error??=`Cannot convert ${JSON.stringify(t)};`,Ret.Invalid(`Formatter '${Types.name(n)}.${r}' error: ${s.error}`);t=s.value}if(null!==s){const e=DataValidator.#a(t,s,r+1);if(!e.valid)return e.error=`${Types.name(n)}\n=> ${e.error}`,e;t=e.value}return Ret.Valid(t)}}